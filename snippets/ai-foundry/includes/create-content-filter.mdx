
## Create a content filter in Azure AI Foundry

For any model deployment in [Azure AI Foundry](https://ai.azure.com/?cid=learnDocs), you can directly use the default content filter, but you might want to have more control. For example, you could make a filter stricter or more lenient, or enable more advanced capabilities like prompt shields and protected material detection.

<Info>
The GPT-image-1 model does not support content filtering configuration: only the default content filter is used.
</Info>

<Tip>
For guidance with content filters in your Azure AI Foundry project, you can read more at [Azure AI Foundry content filtering](/azure/ai-studio/concepts/content-filtering).
</Tip>

Follow these steps to create a content filter:

import TipLeftPane from '/snippets/ai-foundry/includes/tip-left-pane.mdx'

<TipLeftPane />

1. Go to [Azure AI Foundry](https://ai.azure.com/?cid=learnDocs) and navigate to your project. Then select the **Guardrails + controls** page from the left menu and select the **Content filters** tab.

    <Frame>
        ![](/images/ai-foundry/media/content-safety/content-filter/create-content-filter.png)
    </Frame>

1. Select **+ Create content filter**.
1. On the **Basic information** page, enter a name for your content filtering configuration. Select a connection to associate with the content filter. Then select **Next**.

    <Frame>
        ![](/images/ai-foundry/media/content-safety/content-filter/create-content-filter-basic.png)
    </Frame>

    Now you can configure the input filters (for user prompts) and output filters (for model completion). 
1. On the **Input filters** page, you can set the filter for the input prompt. For the first four content categories there are three severity levels that are configurable: Low, medium, and high. You can use the sliders to set the severity threshold if you determine that your application or usage scenario requires different filtering than the default values. 
    Some filters, such as Prompt Shields and Protected material detection, enable you to determine if the model should annotate and/or block content. Selecting **Annotate only** runs the respective model and returns annotations via API response, but it will not filter content. In addition to annotate, you can also choose to block content.

    If your use case was approved for modified content filters, you receive full control over content filtering configurations and can choose to turn filtering partially or fully off, or enable annotate only for the content harms categories (violence, hate, sexual and self-harm).

    Content will be annotated by category and blocked according to the threshold you set. For the violence, hate, sexual, and self-harm categories, adjust the slider to block content of high, medium, or low severity.

    <Frame>
        ![](/images/ai-foundry/media/content-safety/content-filter/input-filter.png)
    </Frame>

1. On the **Output filters** page, you can configure the output filter, which will be applied to all output content generated by your model. Configure the individual filters as before. This page also provides the Streaming mode option, which lets you filter content in near-real-time as it's generated by the model, reducing latency. When you're finished select **Next**. 
    
    Content will be annotated by each category and blocked according to the threshold. For violent content, hate content, sexual content, and self-harm content category, adjust the threshold to block harmful content with equal or higher severity levels.

    <Frame>
        ![](/images/ai-foundry/media/content-safety/content-filter/output-filter.png)
    </Frame>

1. Optionally, on the **Deployment** page, you can associate the content filter with a deployment. If a selected deployment already has a filter attached, you must confirm that you want to replace it. You can also associate the content filter with a deployment later. Select **Create**.

    <Frame>
        ![](/images/ai-foundry/media/content-safety/content-filter/create-content-filter-deployment.png)
    </Frame>

    Content filtering configurations are created at the hub level in the [Azure AI Foundry portal](https://ai.azure.com/?cid=learnDocs). Learn more about configurability in the [Azure OpenAI in Azure AI Foundry Models documentation](/azure/ai-services/openai/how-to/content-filters).


1. On the **Review** page, review the settings and then select **Create filter**.

### Use a blocklist as a filter

You can apply a blocklist as either an input or output filter, or both. Enable the **Blocklist** option on the **Input filter** and/or **Output filter** page. Select one or more blocklists from the dropdown, or use the built-in profanity blocklist. You can combine multiple blocklists into the same filter.

## Apply a content filter

The filter creation process gives you the option to apply the filter to the deployments you want. You can also change or remove content filters from your deployments at any time.

Follow these steps to apply a content filter to a deployment:

1. Go to [Azure AI Foundry](https://ai.azure.com/?cid=learnDocs) and select a project.
1. Select **Models + endpoints** on the left pane and choose one of your deployments, then select **Edit**.

    <Frame>
        ![](/images/ai-foundry/media/content-safety/content-filter/deployment-edit.png)
    </Frame>

1. In the **Update deployment** window, select the content filter you want to apply to the deployment. Then select **Save and close**.

    <Frame>
        ![](/images/ai-foundry/media/content-safety/content-filter/apply-content-filter.png)
    </Frame>

    You can also edit and delete a content filter configuration if required. Before you delete a content filtering configuration, you will need to unassign and replace it from any deployment in the **Deployments** tab.

Now, you can go to the playground to test whether the content filter works as expected.

<Tip>
You can also create and update content filters using the REST APIs. For more information, see the [API reference](/rest/api/aiservices/accountmanagement/rai-policies/create-or-update). Content filters can be configured at the resource level. Once a new configuration is created, it can be associated with one or more deployments. For more information about model deployment, see the resource [deployment guide](../openai/how-to/create-resource). 
</Tip>